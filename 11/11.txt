Практикалық жұмыс 11. Қазіргі заманғы құралдарды қолдану арқылы жасырын хабарды анықтау

Мақсаты
Заманауи стегоанализ құралдары мен әдістерін тәжірибеде қолдануды үйрену.
Сурет, аудио, бейне және мәтіндік файлдардағы жасырын хабарларды табу тәсілдерін меңгеру.
Python кітапханалары мен автоматтандырылған детектор бағдарламалары арқылы стеганографиялық іздерді анықтау.
Қауіпсіздік тұрғысынан ақпараттың тұтастығын талдау және бұзылу индикаторларын (anomalies) тану.

Теориялық бөлім
1. Стегоанализ (Steganalysis) ұғымы
Стегоанализ – ақпараттың тасымалдаушы файлға енгізілгенін немесе жасырылғанын анықтау процесі.
Ол көбіне статистикалық, визуалдық және машиналық оқыту әдістерін қолданады.
2. Негізгі заманауи құралдар
Құрал
Сипаттамасы
Қолданылу аймағы
StegExpose
Автоматты LSB және визуалды талдау негізіндегі анықтау құралы
PNG, BMP
StegDetect
JPEG стеганографиясын табуға арналған классикалық құрал
JPEG
OpenStego
Ашық кодты GUI/CLI құрал, хабарды енгізу және табу мүмкіндігі бар
PNG, BMP
zsteg
PNG және BMP файлдарындағы LSB, palette және alpha-channel аномалияларын табады
суреттер
OutGuess
JPEG суреттерден жасырын деректерді шығару құралы
JPEG
DeepSteg / TensorStegNet
Нейрондық желі негізіндегі анықтау әдістері
кез келген форматтар

3. Негізгі анықтау принциптері
LSB-анализ – соңғы биттердің табиғи емес үлестірімін анықтайды.
Гистограмма анализі – түстер жиілігінің қалыпты таралуынан ауытқуларды іздейді.
Статистикалық тестілер – χ², RS анализ, энтропия.
Машиналық оқыту – CNN, Random Forest модельдері арқылы суреттен жасырын паттерндерді тану.
Қолтаңба детекциясы (signature-based) – белгілі стеганографиялық бағдарламалардың қалдырған іздерін анықтау.

Қадамдық нұсқаулық
1. Құралдарды орнату
Linux / Windows
# StegExpose (Java)
sudo apt install openjdk-11-jre
wget https://github.com/b3dk7/StegExpose/releases/download/v1.0/StegExpose.jar
Python кітапханалары
pip install stegano opencv-python numpy matplotlib scikit-learn pillow
zsteg (Linux)
sudo apt install ruby
sudo gem install zsteg

2. StegExpose арқылы автоматты талдау
java -jar StegExpose.jar hidden.png -a
Нәтиже: бағдарлама LSB үлгілерін, бит теңгерімсіздігін және энтропия аномалияларын шығарады.
Табылған файлдар "suspicious" деп белгіленеді.

3. zsteg арқылы PNG/BMP анализ
zsteg suspect.png
Шығарылым үлгісі:
b1,rgb,lsb,xy : text "Hidden message detected"

4. StegDetect арқылы JPEG анализ
stegdetect suspect.jpg
Талдау нәтижесі:
suspect.jpg : jsteg(0.94)
(0.94 – ықтималдық көрсеткіші.)

5. Python көмегімен статистикалық талдау
Мысал: LSB бит таралуын тексеру
from PIL import Image
import numpy as np
img = Image.open("suspect.png").convert("RGB")
arr = np.array(img)
lsb = arr & 1
zeros, ones = np.sum(lsb == 0), np.sum(lsb == 1)
print("0 биттер:", zeros, "| 1 биттер:", ones)
if abs(zeros - ones) < 0.5 * (zeros + ones) * 0.05:
    print("Күдікті LSB теңгерім байқалады!")

6. Визуалды айырмашылық анализі
Таза сурет пен күдікті суретті салыстыру:
import cv2
img1 = cv2.imread("original.png")
img2 = cv2.imread("suspect.png")
diff = cv2.absdiff(img1, img2)
cv2.imwrite("diff.png", diff)
Diff.png – айырмашылық картасы.

7. Машиналық оқыту арқылы детекция
from sklearn.ensemble import RandomForestClassifier
# features: histogram, entropy, etc.
# classifier.train(clean_images, stego_images)
# result = classifier.predict(new_image_features)

8. Нәтижелерді бағалау
Файл өлшемін, гистограмманы, LSB үлестірімін және энтропияны салыстырыңыз.
Нәтижелерді «күмәнді», «таза», «жасырын хабар бар» деп топтастырыңыз.

Практикада мысалдар
Мысал 1. StegExpose арқылы LSB енгізілген PNG файлын анықтау.
Мысал 2. zsteg көмегімен альфа-каналда жасырылған хабарды табу.
Мысал 3. StegDetect арқылы JPEG файлдағы OutGuess ізін табу.
Мысал 4. Python-да LSB статистикалық талдау және гистограмма айырмасын есептеу.

Қорытынды
Қазіргі заманғы стегоанализ құралдары визуалдыдан гөрі статистикалық және машиналық әдістерге сүйенеді.
StegExpose, zsteg және StegDetect – практикалық қолдануға ыңғайлы, бірақ тереңдетілген жасанды интеллект модельдері анағұрлым сенімді нәтиже береді.
Файл өлшемі, гистограмма мен LSB теңгерімі — негізгі индикаторлар.
Ақпараттық қауіпсіздікте стегоанализ қолданушы мен ұйымның деректерін қорғауда маңызды рөл атқарады.

Студенттерге жеке практикалық тапсырмалар 
StegExpose көмегімен бірнеше PNG суретті тексеріңіз.
zsteg арқылы түрлі түсті каналдарда жасырын хабар бар-жоғын талдаңыз.
StegDetect арқылы JPEG суреттерді тексеріңіз.
LSB таралуын Python кодымен есептеңіз.
PNG және BMP форматтарында анықтау дәлдігін салыстырыңыз.
Файл өлшемінің өзгерісін өлшеңіз (жасырылған хабар бар/жоқ).
Diff-сурет құрып, айырмашылық аймақтарын белгілеңіз.
χ² тестін қолданып аномалия бар-жоғын тексеріңіз.
Entropy мәнін есептеп, қалыпты диапазонмен салыстырыңыз.
Бірнеше файлды StegExpose арқылы batch режимінде талдаңыз.
zsteg нәтижелерін CSV форматында сақтаңыз.
StegDetect ықтималдық көрсеткіштерін талдаңыз.
LSB анализін автоматтандыратын Python скрипт жазыңыз.
StegExpose және Python әдістерінің дәлдігін салыстырыңыз.
BMP форматында палитралық стеганографияны анықтаңыз.
Мәтіндік стеганографияны табу (Zero-width символдарды санау).
WAV аудио файлындағы жасырын хабарды табу үшін FFT талдау жасаңыз.
OutGuess арқылы енгізілген JPEG файлды анықтаңыз.
DCT негізіндегі хабарларды табу үшін жиілік коэффициенттерін талдаңыз.
Таза және күдікті файлдар үшін бит корреляциясын салыстырыңыз.
Машиналық оқыту арқылы қарапайым классификатор құрастырыңыз.
PNG және JPG форматтарында энтропия айырмасын есептеңіз.
Белгілі бір бағдарлама (мысалы, OpenStego) қалдырған іздерді табыңыз.
Бір суретке енгізілген бірнеше хабарды табуға тырысыңыз.
Бейне файлдың кадрларындағы айырмашылықтарды талдаңыз.
Файл метадеректерін тексеріп, жасырын мәтін бар-жоғын анықтаңыз.
Тексеру нәтижелерін есеп кестесі ретінде сақтаңыз.
LSB теңгерім коэффициентін есептеу формуласын шығарыңыз.
Көп құралмен тексеру нәтижелерін салыстырып, сенімділікті бағалаңыз.
“Қазіргі құралдармен жасырын хабарды анықтаудың тиімділігі” тақырыбында қорытынды есеп жазыңыз.

